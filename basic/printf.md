# 格式化输出 printf

[TOC]

## 第一个 C 语言程序

我们在前面已经写过一个打印 Hello World 的 C 语言代码，那正是我们的第一个 C 语言程序：

```c
#include <stdio.h>

int main()
{
    printf("Hello World!\n");
    return 0;
}
```

C  程序代码写好后，需要编译成机器码：

```bash
gcc test.c -o test
```

然后运行生成的可执行文件即可：

```bash
./test
```

如果一切顺利，屏幕上应该打印出了 Hello World

## printf 概述

printf 中的 f 是 format 的简写，printf 的含义是格式化输出函数。C 语言为我们提供了很多基本函数，它们用于实现不同的功能，printf 函数就是其中之一，用来实现格式化输出的功能。

printf 函数用于打印格式化字符串到标准输出流。

## 转义字符

在 C 语言中，用双引号括起来的内容我们称之为字符串，也就是我们平时所说的文本。

字符串可以分为可见字符和转义字符。

可见字符就是屏幕中可以正常显示的普通字符；转义字符指的是有特殊含义的不能直观显示的字符，通常以反斜杠开头。

C 语言中的转义字符及含义如下：

| 转义字符 | 含义                                 |
| :------- | ------------------------------------ |
| \\a      | 响铃（BEL）                          |
| \\b      | 退格（BS），将当前位置移到前一列     |
| \\f      | 换页（FF），将当前位置移到下页开头   |
| \\n      | 换行（FL），将当前位置移到下一行开头 |
| \\r      | 回车（CR），将当前位置移到本行开头   |
| \\t      | 水平制表（HT），跳到下一个 TAB 位置  |
| \\v      | 垂直制表（BT）                       |
| \\\\     | 表示反斜杠本身（\\）                 |
| \\\'     | 表示单引号（\'）                     |
| \\\"     | 表示双引号（\"）                     |
| \\?      | 表示问号（?）                        |
| \\0      | 表示空字符（NULL）                   |
| \\ddd    | 1 到 3 位八进制数所代表的任意字符    |
| \\xhh    | 1 到 2 位十六进制数所代表的任意字符  |

## 末尾反斜杠

在字符串中反斜杠 + 字符是转义字符，表示特殊含义。但如果在代码的末尾出现了反斜杠，不携带任何其他字符直接换行，则表示我们希望 C 语言将该行以及下一行看做是一个整体。

比如我们正常的 Hello World 代码：

```c
#include <stdio.h>

int main()
{
        printf("Hello World!\n");
        return 0;
}
```

我们可以将其拆分成这个样子：

```c
#in\
clude \
<stdio.h>

int ma\
in()
{
        print\
f("Hello World!\n");
        return \
0;
}
```

当然，像上面这样把代码拆零碎是没有意义的。但是在某些情况下，比如代码长度很长，一行显示不合适的情况下，我们可以使用末尾反斜杠的方式换行，提高可读性。

## 格式化输出

### 函数原型

```c
#include <stdio.h>
...
int printf ( const char * format, ... );
```

格式化占位符（以 % 开头）用于指明输出的参数值如何格式化。

格式化占位符的语法如下：

```c
"%[flags][width][.precision][length]specifier"
```

每一个格式化占位符均以 % 开始，以转换字符结束。

### specifier 转换字符，必选

| 转换字符 | 参数类型；转换结果                                           |
| -------- | ------------------------------------------------------------ |
| c        | char；字符                                                   |
| d        | int；有符号十进制整数                                        |
| i        | 同上                                                         |
| e        | double；以指数形式输出单、双精度浮点数（小写 e）             |
| E        | 同上（大写 E）                                               |
| f        | double；以小数形式输出单、双精度浮点数                       |
| g        | double；以 %f 或 %e 中较短的输出宽度输出单、双精度浮点数（指数显示小写 e） |
| G        | 同上（指数显示大写 E）                                       |
| o        | unsigned int；无符号八进制（无前导 0）                       |
| s        | char \*；字符串                                              |
| u        | int；无符号十进制                                            |
| x        | unsigned int；无符号十六进制（无前导 0x）                    |
| X        | 同上（无前导 0X）                                            |
| p        | void \*；指针值                                              |
| n        | int \*；存放已写字符的个数                                   |
| %        | 不进行参数转换；% 自身                                       |

注：如果 % 后边的字符不是转换字符，则其行为没有定义。

### flags 标志

| 标志 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| -    | 指定被转换的参数在其字段内左对齐（默认是右对齐）             |
| +    | 指定在输出的数前面加上正负号                                 |
| 空格 | 如果第一个字符不是正负号，则在其前面加上一个空格             |
| 0    | 对于数值转换，当输出长度小于字段宽度时，添加前导 0 进行填充  |
| #    | 指定另一种输出形式： <br />1. 如果转换字符为 o，则第一个数字为 0<br />2. 如果转换字符为 x 或 X，则指定在输出的非 0 值前加 0x 或 0X<br />3. 对于转换字符为 e、E、f、g 或 G 的情况，指定输出总是包含一个小数点。另外，对于转换字符为 g 或 G，还指定输出值尾部无意义的 0 将被保留 |

注：flags 可同时出现多个，且无顺序要求。

### width（宽度，可选）

width（宽度，可选）是一个数值，用于指定最小字段的宽度

- 对于字符串，它指定打印的字符的最大个数
- 对于整数，它指定打印的数字位数（必要时可加填充位 0 以达到宽度要求）
- 对于转换字符为 e、E 或 f，它指定打印的小数点后的数字位数
- 对于转换字符为 g 或 G，它指定打印的有效数字位数

### length（长度修饰符，可选）

length（长度修饰符，可选）的值可以是 h、hh、l、ll 或 L

- hh 表示将相应的参数按 signed char 或 unsigned char 类型输出
- h 表示将相应的参数按 short 或 unsigned short 类型输出
- l 表示将相应的参数按 long 或 unsigned long 类型输出
- ll 表示将相应的参数按 long long 或 unsigned long long 类型输出
- L 表示将相应的参数按 long double 类型输出

### ... 附加参数


该参数的个数由格式化字符串决定。

如果函数调用成功，返回值是实际打印的字符数（不包含表示字符串结束的 '\\0'）。